---
title: "small_skew_3cat_diverg_analysis"
output: html_document
date: "2023-10-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Load the data 
```{r}
library(miceadds)
data <- do.call(rbind,lapply(paste0("largen_skew_7cat_randompo_modeff_slight",c(1:50),".Rdata"), load.Rdata2))

attach(data)
```

## Check R-hats are all < 1.01 

```{r}
# PO model 
summary(rhat_cumlogit_po1)

# PPO model 
summary(rhat_cumlogit_ppo1)
summary(rhat_cumlogit_ppo2)
summary(rhat_cumlogit_ppo3)
summary(rhat_cumlogit_ppo4)
summary(rhat_cumlogit_ppo5)
summary(rhat_cumlogit_ppo6)


# Constrained- divergent 
summary(rhat_cumlogit_cpo1)
summary(rhat_cumlogit_cpo2)
summary(rhat_cumlogit_cpo3)
summary(rhat_cumlogit_cpo4)
summary(rhat_cumlogit_cpo5)
summary(rhat_cumlogit_cpo6)


# Constrained- linear 
summary(rhat_cumlogit_lcpo1)
summary(rhat_cumlogit_lcpo2)
summary(rhat_cumlogit_lcpo3)
summary(rhat_cumlogit_lcpo4)
summary(rhat_cumlogit_lcpo5)
summary(rhat_cumlogit_lcpo6)


# Logistic 
summary(rhat_cumlogit_lr1)
summary(rhat_cumlogit_lr2)
summary(rhat_cumlogit_lr3)
summary(rhat_cumlogit_lr4)
summary(rhat_cumlogit_lr5)
summary(rhat_cumlogit_lr6)


```

## Check bulk ESS are sufficiently large (minimum 400, ideally above 1000)
```{r}
# PO model 
summary(bulkess_cumlogit_po1)

# PPO model 
summary(bulkess_cumlogit_ppo1)
summary(bulkess_cumlogit_ppo2)
summary(bulkess_cumlogit_ppo3)
summary(bulkess_cumlogit_ppo4)
summary(bulkess_cumlogit_ppo5)
summary(bulkess_cumlogit_ppo6)


# Constrained- divergent 
summary(bulkess_cumlogit_cpo1)
summary(bulkess_cumlogit_cpo2)
summary(bulkess_cumlogit_cpo3)
summary(bulkess_cumlogit_cpo4)
summary(bulkess_cumlogit_cpo5)
summary(bulkess_cumlogit_cpo6)


# Constrained- linear 
summary(bulkess_cumlogit_lcpo1)
summary(bulkess_cumlogit_lcpo2)
summary(bulkess_cumlogit_lcpo3)
summary(bulkess_cumlogit_lcpo4)
summary(bulkess_cumlogit_lcpo5)
summary(bulkess_cumlogit_lcpo6)



# Logistic 
summary(bulkess_cumlogit_lr1)
summary(bulkess_cumlogit_lr2)
summary(bulkess_cumlogit_lr3)
summary(bulkess_cumlogit_lr4)
summary(bulkess_cumlogit_lr5)
summary(bulkess_cumlogit_lr6)


```

## Check tail ESS are sufficiently large (should be >400, ideally above 1000)
```{r}
# PO model 
summary(tailess_cumlogit_po1)

# PPO model 
summary(tailess_cumlogit_ppo1)
summary(tailess_cumlogit_ppo2)
summary(tailess_cumlogit_ppo3)
summary(tailess_cumlogit_ppo4)
summary(tailess_cumlogit_ppo5)
summary(tailess_cumlogit_ppo6)



# Constrained- divergent 
summary(tailess_cumlogit_cpo1)
summary(tailess_cumlogit_cpo2)
summary(tailess_cumlogit_cpo3)
summary(tailess_cumlogit_cpo4)
summary(tailess_cumlogit_cpo5)
summary(tailess_cumlogit_cpo6)


# Constrained- linear 
summary(tailess_cumlogit_lcpo1)
summary(tailess_cumlogit_lcpo2)
summary(tailess_cumlogit_lcpo3)
summary(tailess_cumlogit_lcpo4)
summary(tailess_cumlogit_lcpo5)
summary(tailess_cumlogit_lcpo6)


# Logistic 
summary(tailess_cumlogit_lr1)
summary(tailess_cumlogit_lr2)
summary(tailess_cumlogit_lr3)
summary(tailess_cumlogit_lr4)
summary(tailess_cumlogit_lr5)
summary(tailess_cumlogit_lr6)

```


## Check that the MCSE meets upper bound of 0.01 
```{r}
# PO model 
summary(mcse_cumlogit_po1)

# PPO model 
summary(mcse_cumlogit_ppo1)
summary(mcse_cumlogit_ppo2)
summary(mcse_cumlogit_ppo3)
summary(mcse_cumlogit_ppo4)
summary(mcse_cumlogit_ppo5)
summary(mcse_cumlogit_ppo6)


# Constrained- divergent 
summary(mcse_cumlogit_cpo1)
summary(mcse_cumlogit_cpo2)
summary(mcse_cumlogit_cpo3)
summary(mcse_cumlogit_cpo4)
summary(mcse_cumlogit_cpo5)
summary(mcse_cumlogit_cpo6)


# Constrained- linear 
summary(mcse_cumlogit_lcpo1)
summary(mcse_cumlogit_lcpo2)
summary(mcse_cumlogit_lcpo3)
summary(mcse_cumlogit_lcpo4)
summary(mcse_cumlogit_lcpo5)
summary(mcse_cumlogit_lcpo6)


# Logistic 
summary(mcse_cumlogit_lr1)
summary(mcse_cumlogit_lr2)
summary(mcse_cumlogit_lr3)
summary(mcse_cumlogit_lr4)
summary(mcse_cumlogit_lr5)
summary(mcse_cumlogit_lr6)
```

## Check reports on missing values 
```{r}
# PO model 
summary(missing_po)

# PPO model 
summary(missing_ppo)

# Constrained- divergent 
summary(missing_cpo)

# Constrained- linear 
summary(missing_lcpo)

# Logistic 
summary(missing_lr1)
summary(missing_lr2)
summary(missing_lr3)
summary(missing_lr4)
summary(missing_lr5)
summary(missing_lr6)

```

## Check number of divergent transitions - this should be kept to a minimum if any (<10)
```{r}
# PO model 
summary(numdivergent_po)

# PPO model 
summary(numdivergent_ppo)

# Constrained- divergent 
summary(numdivergent_cpo)

# Constrained- linear 
summary(numdivergent_lcpo)

# Logistic 
summary(numdivergent_lr1)
summary(numdivergent_lr2)
summary(numdivergent_lr3)
summary(numdivergent_lr4)
summary(numdivergent_lr5)
summary(numdivergent_lr6)
```

## Calculate performance measures 
## Bias across each model and cumulative logit 
```{r}
#PO model 
bias_po1 <- mean(bias_cumlogit_po1)
bias_po2 <- mean(bias_cumlogit_po2)
bias_po3 <- mean(bias_cumlogit_po3)
bias_po4 <- mean(bias_cumlogit_po4)
bias_po5 <- mean(bias_cumlogit_po5)
bias_po6 <- mean(bias_cumlogit_po6)

# PPO model 
bias_ppo1 <- mean(bias_cumlogit_ppo1)
bias_ppo2 <- mean(bias_cumlogit_ppo2)
bias_ppo3 <- mean(bias_cumlogit_ppo3)
bias_ppo4 <- mean(bias_cumlogit_ppo4)
bias_ppo5 <- mean(bias_cumlogit_ppo5)
bias_ppo6 <- mean(bias_cumlogit_ppo6)


# Constrained - divergent 
bias_cpo1 <- mean(bias_cumlogit_cpo1)
bias_cpo2 <- mean(bias_cumlogit_cpo2)
bias_cpo3 <- mean(bias_cumlogit_cpo3)
bias_cpo4 <- mean(bias_cumlogit_cpo4)
bias_cpo5 <- mean(bias_cumlogit_cpo5)
bias_cpo6 <- mean(bias_cumlogit_cpo6)

# Constrained - linear 
bias_lcpo1 <- mean(bias_cumlogit_lcpo1)
bias_lcpo2 <- mean(bias_cumlogit_lcpo2)
bias_lcpo3 <- mean(bias_cumlogit_lcpo3)
bias_lcpo4 <- mean(bias_cumlogit_lcpo4)
bias_lcpo5 <- mean(bias_cumlogit_lcpo5)
bias_lcpo6 <- mean(bias_cumlogit_lcpo6)

# Logistic 
bias_lr1 <- mean(bias_cumlogit_lr1)
bias_lr2 <- mean(bias_cumlogit_lr2)
bias_lr3 <- mean(bias_cumlogit_lr3)
bias_lr4 <- mean(bias_cumlogit_lr4)
bias_lr5 <- mean(bias_cumlogit_lr5)
bias_lr6 <- mean(bias_cumlogit_lr6)

```

## Coverage across each model and cumulative logit 
```{r}
#PO model 
cv_po1 <- mean(cv_cumlogit_po1)
cv_po2 <- mean(cv_cumlogit_po2)
cv_po3 <- mean(cv_cumlogit_po3)
cv_po4 <- mean(cv_cumlogit_po4)
cv_po5 <- mean(cv_cumlogit_po5)
cv_po6 <- mean(cv_cumlogit_po6)


# PPO model 
cv_ppo1 <- mean(cv_cumlogit_ppo1)
cv_ppo2 <- mean(cv_cumlogit_ppo2)
cv_ppo3 <- mean(cv_cumlogit_ppo3)
cv_ppo4 <- mean(cv_cumlogit_ppo4)
cv_ppo5 <- mean(cv_cumlogit_ppo5)
cv_ppo6 <- mean(cv_cumlogit_ppo6)

# Constrained - divergent 
cv_cpo1 <- mean(cv_cumlogit_cpo1)
cv_cpo2 <- mean(cv_cumlogit_cpo2)
cv_cpo3 <- mean(cv_cumlogit_cpo3)
cv_cpo4 <- mean(cv_cumlogit_cpo4)
cv_cpo5 <- mean(cv_cumlogit_cpo5)
cv_cpo6 <- mean(cv_cumlogit_cpo6)


# Constrained - linear 
cv_lcpo1 <- mean(cv_cumlogit_lcpo1)
cv_lcpo2 <- mean(cv_cumlogit_lcpo2)
cv_lcpo3 <- mean(cv_cumlogit_lcpo3)
cv_lcpo4 <- mean(cv_cumlogit_lcpo4)
cv_lcpo5 <- mean(cv_cumlogit_lcpo5)
cv_lcpo6 <- mean(cv_cumlogit_lcpo6)

# Logistic 
cv_lr1 <- mean(cv_cumlogit_lr1)
cv_lr2 <- mean(cv_cumlogit_lr2)
cv_lr3 <- mean(cv_cumlogit_lr3)
cv_lr4 <- mean(cv_cumlogit_lr4)
cv_lr5 <- mean(cv_cumlogit_lr5)
cv_lr6 <- mean(cv_cumlogit_lr6)

```


## MSE across each model and cumulative logit 
```{r}
#PO model 
mse_po1 <- mean(mse_cumlogit_po1)
mse_po2 <- mean(mse_cumlogit_po2)
mse_po3 <- mean(mse_cumlogit_po3)
mse_po4 <- mean(mse_cumlogit_po4)
mse_po5 <- mean(mse_cumlogit_po5)
mse_po6 <- mean(mse_cumlogit_po6)



# PPO model 
mse_ppo1 <- mean(mse_cumlogit_ppo1)
mse_ppo2 <- mean(mse_cumlogit_ppo2)
mse_ppo3 <- mean(mse_cumlogit_ppo3)
mse_ppo4 <- mean(mse_cumlogit_ppo4)
mse_ppo5 <- mean(mse_cumlogit_ppo5)
mse_ppo6 <- mean(mse_cumlogit_ppo6)



# Constrained - divergent 
mse_cpo1 <- mean(mse_cumlogit_cpo1)
mse_cpo2 <- mean(mse_cumlogit_cpo2)
mse_cpo3 <- mean(mse_cumlogit_cpo3)
mse_cpo4 <- mean(mse_cumlogit_cpo4)
mse_cpo5 <- mean(mse_cumlogit_cpo5)
mse_cpo6 <- mean(mse_cumlogit_cpo6)



# Constrained - linear 
mse_lcpo1 <- mean(mse_cumlogit_lcpo1)
mse_lcpo2 <- mean(mse_cumlogit_lcpo2)
mse_lcpo3 <- mean(mse_cumlogit_lcpo3)
mse_lcpo4 <- mean(mse_cumlogit_lcpo4)
mse_lcpo5 <- mean(mse_cumlogit_lcpo5)
mse_lcpo6 <- mean(mse_cumlogit_lcpo6)



# Logistic 
mse_lr1 <- mean(mse_cumlogit_lr1)
mse_lr2 <- mean(mse_cumlogit_lr2)
mse_lr3 <- mean(mse_cumlogit_lr3)
mse_lr4 <- mean(mse_cumlogit_lr4)
mse_lr5 <- mean(mse_cumlogit_lr5)
mse_lr6 <- mean(mse_cumlogit_lr6)

```


## Compute jackknife-after-bootstrap Monte Carlo standard error estimation - BIAS 
## These should be <0.05, otherwise increase n_sim 
```{r}
nsim <- 1000

MC_YMinusi_bias1_po <- MC_YMinusi_bias2_po <- MC_YMinusi_bias3_po <- MC_YMinusi_bias4_po <- MC_YMinusi_bias5_po <- MC_YMinusi_bias6_po  <- MC_YMinusi_bias1_ppo <- MC_YMinusi_bias2_ppo <- MC_YMinusi_bias3_ppo <- MC_YMinusi_bias4_ppo <- MC_YMinusi_bias5_ppo <- MC_YMinusi_bias6_ppo <- MC_YMinusi_bias1_cpo <- MC_YMinusi_bias2_cpo <- MC_YMinusi_bias3_cpo <- MC_YMinusi_bias4_cpo <- MC_YMinusi_bias5_cpo <- MC_YMinusi_bias6_cpo <- MC_YMinusi_bias1_lcpo <- MC_YMinusi_bias2_lcpo <- MC_YMinusi_bias3_lcpo <- MC_YMinusi_bias4_lcpo <- MC_YMinusi_bias5_lcpo <- MC_YMinusi_bias6_lcpo <- MC_YMinusi_bias1_lr <- MC_YMinusi_bias2_lr <- MC_YMinusi_bias3_lr <- MC_YMinusi_bias4_lr <- MC_YMinusi_bias5_lr <- MC_YMinusi_bias6_lr <- numeric(nsim)

for(i in 1:nsim){
  MC_YMinusi_bias1_po[i] = sum(bias_cumlogit_po1[-i])/(nsim-1)
  MC_YMinusi_bias2_po[i] = sum(bias_cumlogit_po2[-i])/(nsim-1)
  MC_YMinusi_bias3_po[i] = sum(bias_cumlogit_po3[-i])/(nsim-1)
  MC_YMinusi_bias4_po[i] = sum(bias_cumlogit_po4[-i])/(nsim-1)
  MC_YMinusi_bias5_po[i] = sum(bias_cumlogit_po5[-i])/(nsim-1)
  MC_YMinusi_bias6_po[i] = sum(bias_cumlogit_po6[-i])/(nsim-1)


  MC_YMinusi_bias1_ppo[i] = sum(bias_cumlogit_ppo1[-i])/(nsim-1)
  MC_YMinusi_bias2_ppo[i] = sum(bias_cumlogit_ppo2[-i])/(nsim-1)
  MC_YMinusi_bias3_ppo[i] = sum(bias_cumlogit_ppo3[-i])/(nsim-1)
  MC_YMinusi_bias4_ppo[i] = sum(bias_cumlogit_ppo4[-i])/(nsim-1)
  MC_YMinusi_bias5_ppo[i] = sum(bias_cumlogit_ppo5[-i])/(nsim-1)
  MC_YMinusi_bias6_ppo[i] = sum(bias_cumlogit_ppo6[-i])/(nsim-1)


  MC_YMinusi_bias1_cpo[i] = sum(bias_cumlogit_cpo1[-i])/(nsim-1)
  MC_YMinusi_bias2_cpo[i] = sum(bias_cumlogit_cpo2[-i])/(nsim-1)
  MC_YMinusi_bias3_cpo[i] = sum(bias_cumlogit_cpo3[-i])/(nsim-1)
  MC_YMinusi_bias4_cpo[i] = sum(bias_cumlogit_cpo4[-i])/(nsim-1)
  MC_YMinusi_bias5_cpo[i] = sum(bias_cumlogit_cpo5[-i])/(nsim-1)
  MC_YMinusi_bias6_cpo[i] = sum(bias_cumlogit_cpo6[-i])/(nsim-1)
  
  MC_YMinusi_bias1_lcpo[i] = sum(bias_cumlogit_lcpo1[-i])/(nsim-1)
  MC_YMinusi_bias2_lcpo[i] = sum(bias_cumlogit_lcpo2[-i])/(nsim-1)
  MC_YMinusi_bias3_lcpo[i] = sum(bias_cumlogit_lcpo3[-i])/(nsim-1)
  MC_YMinusi_bias4_lcpo[i] = sum(bias_cumlogit_lcpo4[-i])/(nsim-1)
  MC_YMinusi_bias5_lcpo[i] = sum(bias_cumlogit_lcpo5[-i])/(nsim-1)
  MC_YMinusi_bias6_lcpo[i] = sum(bias_cumlogit_lcpo6[-i])/(nsim-1)


  MC_YMinusi_bias1_lr[i] = sum(bias_cumlogit_lr1[-i])/(nsim-1)
  MC_YMinusi_bias2_lr[i] = sum(bias_cumlogit_lr2[-i])/(nsim-1) 
  MC_YMinusi_bias3_lr[i] = sum(bias_cumlogit_lr3[-i])/(nsim-1)
  MC_YMinusi_bias4_lr[i] = sum(bias_cumlogit_lr4[-i])/(nsim-1)
  MC_YMinusi_bias5_lr[i] = sum(bias_cumlogit_lr5[-i])/(nsim-1)
  MC_YMinusi_bias6_lr[i] = sum(bias_cumlogit_lr6[-i])/(nsim-1)

}

bar_MC_YMinusi_bias1_po = sum(MC_YMinusi_bias1_po)/nsim
bar_MC_YMinusi_bias2_po = sum(MC_YMinusi_bias2_po)/nsim
bar_MC_YMinusi_bias3_po = sum(MC_YMinusi_bias3_po)/nsim
bar_MC_YMinusi_bias4_po = sum(MC_YMinusi_bias4_po)/nsim
bar_MC_YMinusi_bias5_po = sum(MC_YMinusi_bias5_po)/nsim
bar_MC_YMinusi_bias6_po = sum(MC_YMinusi_bias6_po)/nsim


bar_MC_YMinusi_bias1_ppo = sum(MC_YMinusi_bias1_ppo)/nsim
bar_MC_YMinusi_bias2_ppo = sum(MC_YMinusi_bias2_ppo)/nsim
bar_MC_YMinusi_bias3_ppo = sum(MC_YMinusi_bias3_ppo)/nsim
bar_MC_YMinusi_bias4_ppo = sum(MC_YMinusi_bias4_ppo)/nsim
bar_MC_YMinusi_bias5_ppo = sum(MC_YMinusi_bias5_ppo)/nsim
bar_MC_YMinusi_bias6_ppo = sum(MC_YMinusi_bias6_ppo)/nsim


bar_MC_YMinusi_bias1_cpo = sum(MC_YMinusi_bias1_cpo)/nsim
bar_MC_YMinusi_bias2_cpo = sum(MC_YMinusi_bias2_cpo)/nsim
bar_MC_YMinusi_bias3_cpo = sum(MC_YMinusi_bias3_cpo)/nsim
bar_MC_YMinusi_bias4_cpo = sum(MC_YMinusi_bias4_cpo)/nsim
bar_MC_YMinusi_bias5_cpo = sum(MC_YMinusi_bias5_cpo)/nsim
bar_MC_YMinusi_bias6_cpo = sum(MC_YMinusi_bias6_cpo)/nsim


bar_MC_YMinusi_bias1_lcpo = sum(MC_YMinusi_bias1_lcpo)/nsim
bar_MC_YMinusi_bias2_lcpo = sum(MC_YMinusi_bias2_lcpo)/nsim
bar_MC_YMinusi_bias3_lcpo = sum(MC_YMinusi_bias3_lcpo)/nsim
bar_MC_YMinusi_bias4_lcpo = sum(MC_YMinusi_bias4_lcpo)/nsim
bar_MC_YMinusi_bias5_lcpo = sum(MC_YMinusi_bias5_lcpo)/nsim
bar_MC_YMinusi_bias6_lcpo = sum(MC_YMinusi_bias6_lcpo)/nsim


bar_MC_YMinusi_bias1_lr = sum(MC_YMinusi_bias1_lr)/nsim
bar_MC_YMinusi_bias2_lr = sum(MC_YMinusi_bias2_lr)/nsim
bar_MC_YMinusi_bias3_lr = sum(MC_YMinusi_bias3_lr)/nsim
bar_MC_YMinusi_bias4_lr = sum(MC_YMinusi_bias4_lr)/nsim
bar_MC_YMinusi_bias5_lr = sum(MC_YMinusi_bias5_lr)/nsim
bar_MC_YMinusi_bias6_lr = sum(MC_YMinusi_bias6_lr)/nsim

MCE_JK_bias1_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias1_po-bar_MC_YMinusi_bias1_po)^2))
MCE_JK_bias2_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias2_po-bar_MC_YMinusi_bias2_po)^2))
MCE_JK_bias3_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias3_po-bar_MC_YMinusi_bias3_po)^2))
MCE_JK_bias4_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias4_po-bar_MC_YMinusi_bias4_po)^2))
MCE_JK_bias5_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias5_po-bar_MC_YMinusi_bias5_po)^2))
MCE_JK_bias6_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias6_po-bar_MC_YMinusi_bias6_po)^2))

MCE_JK_bias1_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias1_ppo-bar_MC_YMinusi_bias1_ppo)^2))
MCE_JK_bias2_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias2_ppo-bar_MC_YMinusi_bias2_ppo)^2))
MCE_JK_bias3_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias3_ppo-bar_MC_YMinusi_bias3_ppo)^2))
MCE_JK_bias4_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias4_ppo-bar_MC_YMinusi_bias4_ppo)^2))
MCE_JK_bias5_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias5_ppo-bar_MC_YMinusi_bias5_ppo)^2))
MCE_JK_bias6_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias6_ppo-bar_MC_YMinusi_bias6_ppo)^2))

MCE_JK_bias1_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias1_cpo-bar_MC_YMinusi_bias1_cpo)^2))
MCE_JK_bias2_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias2_cpo-bar_MC_YMinusi_bias2_cpo)^2))
MCE_JK_bias3_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias3_cpo-bar_MC_YMinusi_bias3_cpo)^2))
MCE_JK_bias4_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias4_cpo-bar_MC_YMinusi_bias4_cpo)^2))
MCE_JK_bias5_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias5_cpo-bar_MC_YMinusi_bias5_cpo)^2))
MCE_JK_bias6_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias6_cpo-bar_MC_YMinusi_bias6_cpo)^2))

MCE_JK_bias1_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias1_lcpo-bar_MC_YMinusi_bias1_lcpo)^2))
MCE_JK_bias2_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias2_lcpo-bar_MC_YMinusi_bias2_lcpo)^2))
MCE_JK_bias3_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias3_lcpo-bar_MC_YMinusi_bias3_lcpo)^2))
MCE_JK_bias4_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias4_lcpo-bar_MC_YMinusi_bias4_lcpo)^2))
MCE_JK_bias5_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias5_lcpo-bar_MC_YMinusi_bias5_lcpo)^2))
MCE_JK_bias6_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias6_lcpo-bar_MC_YMinusi_bias6_lcpo)^2))

MCE_JK_bias1_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias1_lr-bar_MC_YMinusi_bias1_lr)^2))
MCE_JK_bias2_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias2_lr-bar_MC_YMinusi_bias2_lr)^2))
MCE_JK_bias3_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias3_lr-bar_MC_YMinusi_bias3_lr)^2))
MCE_JK_bias4_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias4_lr-bar_MC_YMinusi_bias4_lr)^2))
MCE_JK_bias5_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias5_lr-bar_MC_YMinusi_bias5_lr)^2))
MCE_JK_bias6_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_bias6_lr-bar_MC_YMinusi_bias6_lr)^2))

```

## Compute jackknife-after-bootstrap Monte Carlo standard error estimation - COVERAGE 
```{r}
MC_YMinusi_cv1_po <- MC_YMinusi_cv2_po <- MC_YMinusi_cv3_po <- MC_YMinusi_cv4_po <- MC_YMinusi_cv5_po <- MC_YMinusi_cv6_po <- MC_YMinusi_cv1_ppo <- MC_YMinusi_cv2_ppo <- MC_YMinusi_cv3_ppo <- MC_YMinusi_cv4_ppo <- MC_YMinusi_cv5_ppo <- MC_YMinusi_cv6_ppo <- MC_YMinusi_cv1_cpo <- MC_YMinusi_cv2_cpo <- MC_YMinusi_cv3_cpo <- MC_YMinusi_cv4_cpo <- MC_YMinusi_cv5_cpo <- MC_YMinusi_cv6_cpo <- MC_YMinusi_cv1_lcpo <- MC_YMinusi_cv2_lcpo <- MC_YMinusi_cv3_lcpo <- MC_YMinusi_cv4_lcpo <- MC_YMinusi_cv5_lcpo <- MC_YMinusi_cv6_lcpo <-  MC_YMinusi_cv1_lr <- MC_YMinusi_cv2_lr <- MC_YMinusi_cv3_lr <- MC_YMinusi_cv4_lr <- MC_YMinusi_cv5_lr <- MC_YMinusi_cv6_lr <- numeric(nsim)

for(i in 1:nsim){
  MC_YMinusi_cv1_po[i] = sum(cv_cumlogit_po1[-i])/(nsim-1)
  MC_YMinusi_cv2_po[i] = sum(cv_cumlogit_po2[-i])/(nsim-1)
  MC_YMinusi_cv3_po[i] = sum(cv_cumlogit_po3[-i])/(nsim-1)
  MC_YMinusi_cv4_po[i] = sum(cv_cumlogit_po4[-i])/(nsim-1)
  MC_YMinusi_cv5_po[i] = sum(cv_cumlogit_po5[-i])/(nsim-1)
  MC_YMinusi_cv6_po[i] = sum(cv_cumlogit_po6[-i])/(nsim-1)


  MC_YMinusi_cv1_ppo[i] = sum(cv_cumlogit_ppo1[-i])/(nsim-1)
  MC_YMinusi_cv2_ppo[i] = sum(cv_cumlogit_ppo2[-i])/(nsim-1)
  MC_YMinusi_cv3_ppo[i] = sum(cv_cumlogit_ppo3[-i])/(nsim-1)
  MC_YMinusi_cv4_ppo[i] = sum(cv_cumlogit_ppo4[-i])/(nsim-1)
  MC_YMinusi_cv5_ppo[i] = sum(cv_cumlogit_ppo5[-i])/(nsim-1)
  MC_YMinusi_cv6_ppo[i] = sum(cv_cumlogit_ppo6[-i])/(nsim-1)

  MC_YMinusi_cv1_cpo[i] = sum(cv_cumlogit_cpo1[-i])/(nsim-1)
  MC_YMinusi_cv2_cpo[i] = sum(cv_cumlogit_cpo2[-i])/(nsim-1)
  MC_YMinusi_cv3_cpo[i] = sum(cv_cumlogit_cpo3[-i])/(nsim-1)
  MC_YMinusi_cv4_cpo[i] = sum(cv_cumlogit_cpo4[-i])/(nsim-1)
  MC_YMinusi_cv5_cpo[i] = sum(cv_cumlogit_cpo5[-i])/(nsim-1)
  MC_YMinusi_cv6_cpo[i] = sum(cv_cumlogit_cpo6[-i])/(nsim-1)

  
  MC_YMinusi_cv1_lcpo[i] = sum(cv_cumlogit_lcpo1[-i])/(nsim-1)
  MC_YMinusi_cv2_lcpo[i] = sum(cv_cumlogit_lcpo2[-i])/(nsim-1)
  MC_YMinusi_cv3_lcpo[i] = sum(cv_cumlogit_lcpo3[-i])/(nsim-1)
  MC_YMinusi_cv4_lcpo[i] = sum(cv_cumlogit_lcpo4[-i])/(nsim-1)
  MC_YMinusi_cv5_lcpo[i] = sum(cv_cumlogit_lcpo5[-i])/(nsim-1)
  MC_YMinusi_cv6_lcpo[i] = sum(cv_cumlogit_lcpo6[-i])/(nsim-1)


  MC_YMinusi_cv1_lr[i] = sum(cv_cumlogit_lr1[-i])/(nsim-1)
  MC_YMinusi_cv2_lr[i] = sum(cv_cumlogit_lr2[-i])/(nsim-1)
  MC_YMinusi_cv3_lr[i] = sum(cv_cumlogit_lr3[-i])/(nsim-1)
  MC_YMinusi_cv4_lr[i] = sum(cv_cumlogit_lr4[-i])/(nsim-1)
  MC_YMinusi_cv5_lr[i] = sum(cv_cumlogit_lr5[-i])/(nsim-1)
  MC_YMinusi_cv6_lr[i] = sum(cv_cumlogit_lr6[-i])/(nsim-1)
}

bar_MC_YMinusi_cv1_po = sum(MC_YMinusi_cv1_po)/nsim
bar_MC_YMinusi_cv2_po = sum(MC_YMinusi_cv2_po)/nsim
bar_MC_YMinusi_cv3_po = sum(MC_YMinusi_cv3_po)/nsim
bar_MC_YMinusi_cv4_po = sum(MC_YMinusi_cv4_po)/nsim
bar_MC_YMinusi_cv5_po = sum(MC_YMinusi_cv5_po)/nsim
bar_MC_YMinusi_cv6_po = sum(MC_YMinusi_cv6_po)/nsim


bar_MC_YMinusi_cv1_ppo = sum(MC_YMinusi_cv1_ppo)/nsim
bar_MC_YMinusi_cv2_ppo = sum(MC_YMinusi_cv2_ppo)/nsim
bar_MC_YMinusi_cv3_ppo = sum(MC_YMinusi_cv3_ppo)/nsim
bar_MC_YMinusi_cv4_ppo = sum(MC_YMinusi_cv4_ppo)/nsim
bar_MC_YMinusi_cv5_ppo = sum(MC_YMinusi_cv5_ppo)/nsim
bar_MC_YMinusi_cv6_ppo = sum(MC_YMinusi_cv6_ppo)/nsim

bar_MC_YMinusi_cv1_cpo = sum(MC_YMinusi_cv1_cpo)/nsim
bar_MC_YMinusi_cv2_cpo = sum(MC_YMinusi_cv2_cpo)/nsim
bar_MC_YMinusi_cv3_cpo = sum(MC_YMinusi_cv3_cpo)/nsim
bar_MC_YMinusi_cv4_cpo = sum(MC_YMinusi_cv4_cpo)/nsim
bar_MC_YMinusi_cv5_cpo = sum(MC_YMinusi_cv5_cpo)/nsim
bar_MC_YMinusi_cv6_cpo = sum(MC_YMinusi_cv6_cpo)/nsim


bar_MC_YMinusi_cv1_lcpo = sum(MC_YMinusi_cv1_lcpo)/nsim
bar_MC_YMinusi_cv2_lcpo = sum(MC_YMinusi_cv2_lcpo)/nsim
bar_MC_YMinusi_cv3_lcpo = sum(MC_YMinusi_cv3_lcpo)/nsim
bar_MC_YMinusi_cv4_lcpo = sum(MC_YMinusi_cv4_lcpo)/nsim
bar_MC_YMinusi_cv5_lcpo = sum(MC_YMinusi_cv5_lcpo)/nsim
bar_MC_YMinusi_cv6_lcpo = sum(MC_YMinusi_cv6_lcpo)/nsim

bar_MC_YMinusi_cv1_lr = sum(MC_YMinusi_cv1_lr)/nsim
bar_MC_YMinusi_cv2_lr = sum(MC_YMinusi_cv2_lr)/nsim
bar_MC_YMinusi_cv3_lr = sum(MC_YMinusi_cv3_lr)/nsim
bar_MC_YMinusi_cv4_lr = sum(MC_YMinusi_cv4_lr)/nsim
bar_MC_YMinusi_cv5_lr = sum(MC_YMinusi_cv5_lr)/nsim
bar_MC_YMinusi_cv6_lr = sum(MC_YMinusi_cv6_lr)/nsim

MCE_JK_cv1_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv1_po-bar_MC_YMinusi_cv1_po)^2))
MCE_JK_cv2_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv2_po-bar_MC_YMinusi_cv2_po)^2))
MCE_JK_cv3_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv3_po-bar_MC_YMinusi_cv3_po)^2))
MCE_JK_cv4_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv4_po-bar_MC_YMinusi_cv4_po)^2))
MCE_JK_cv5_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv5_po-bar_MC_YMinusi_cv5_po)^2))
MCE_JK_cv6_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv6_po-bar_MC_YMinusi_cv6_po)^2))


MCE_JK_cv1_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv1_ppo-bar_MC_YMinusi_cv1_ppo)^2))
MCE_JK_cv2_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv2_ppo-bar_MC_YMinusi_cv2_ppo)^2))
MCE_JK_cv3_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv3_ppo-bar_MC_YMinusi_cv3_ppo)^2))
MCE_JK_cv4_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv4_ppo-bar_MC_YMinusi_cv4_ppo)^2))
MCE_JK_cv5_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv5_ppo-bar_MC_YMinusi_cv5_ppo)^2))
MCE_JK_cv6_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv6_ppo-bar_MC_YMinusi_cv6_ppo)^2))

MCE_JK_cv1_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv1_cpo-bar_MC_YMinusi_cv1_cpo)^2))
MCE_JK_cv2_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv2_cpo-bar_MC_YMinusi_cv2_cpo)^2))
MCE_JK_cv3_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv3_cpo-bar_MC_YMinusi_cv3_cpo)^2))
MCE_JK_cv4_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv4_cpo-bar_MC_YMinusi_cv4_cpo)^2))
MCE_JK_cv5_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv5_cpo-bar_MC_YMinusi_cv5_cpo)^2))
MCE_JK_cv6_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv6_cpo-bar_MC_YMinusi_cv6_cpo)^2))



MCE_JK_cv1_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv1_lcpo-bar_MC_YMinusi_cv1_lcpo)^2))
MCE_JK_cv2_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv2_lcpo-bar_MC_YMinusi_cv2_lcpo)^2))
MCE_JK_cv3_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv3_lcpo-bar_MC_YMinusi_cv3_lcpo)^2))
MCE_JK_cv4_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv4_lcpo-bar_MC_YMinusi_cv4_lcpo)^2))
MCE_JK_cv5_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv5_lcpo-bar_MC_YMinusi_cv5_lcpo)^2))
MCE_JK_cv6_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv6_lcpo-bar_MC_YMinusi_cv6_lcpo)^2))


MCE_JK_cv1_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv1_lr-bar_MC_YMinusi_cv1_lr)^2))
MCE_JK_cv2_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv2_lr-bar_MC_YMinusi_cv2_lr)^2))
MCE_JK_cv3_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv3_lr-bar_MC_YMinusi_cv3_lr)^2))
MCE_JK_cv4_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv4_lr-bar_MC_YMinusi_cv4_lr)^2))
MCE_JK_cv5_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv5_lr-bar_MC_YMinusi_cv5_lr)^2))
MCE_JK_cv6_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_cv6_lr-bar_MC_YMinusi_cv6_lr)^2))

```

## Compute jackknife-after-bootstrap Monte Carlo standard error estimation - MSE 
```{r}
MC_YMinusi_mse1_po <- MC_YMinusi_mse2_po <- MC_YMinusi_mse3_po <- MC_YMinusi_mse4_po <- MC_YMinusi_mse5_po <- MC_YMinusi_mse6_po <- MC_YMinusi_mse1_ppo <- MC_YMinusi_mse2_ppo <- MC_YMinusi_mse3_ppo <- MC_YMinusi_mse4_ppo <- MC_YMinusi_mse5_ppo <- MC_YMinusi_mse6_ppo  <- MC_YMinusi_mse1_cpo <- MC_YMinusi_mse2_cpo <- MC_YMinusi_mse3_cpo <- MC_YMinusi_mse4_cpo <- MC_YMinusi_mse5_cpo <- MC_YMinusi_mse6_cpo <- MC_YMinusi_mse1_lcpo <- MC_YMinusi_mse2_lcpo <- MC_YMinusi_mse3_lcpo <- MC_YMinusi_mse4_lcpo <- MC_YMinusi_mse5_lcpo <- MC_YMinusi_mse6_lcpo <- MC_YMinusi_mse1_lr <- MC_YMinusi_mse2_lr <- MC_YMinusi_mse3_lr <- MC_YMinusi_mse4_lr <- MC_YMinusi_mse5_lr <- MC_YMinusi_mse6_lr  <- numeric(nsim)

for(i in 1:nsim){
  MC_YMinusi_mse1_po[i] = sum(mse_cumlogit_po1[-i])/(nsim-1)
  MC_YMinusi_mse2_po[i] = sum(mse_cumlogit_po2[-i])/(nsim-1)
  MC_YMinusi_mse3_po[i] = sum(mse_cumlogit_po3[-i])/(nsim-1)
  MC_YMinusi_mse4_po[i] = sum(mse_cumlogit_po4[-i])/(nsim-1)
  MC_YMinusi_mse5_po[i] = sum(mse_cumlogit_po5[-i])/(nsim-1)
  MC_YMinusi_mse6_po[i] = sum(mse_cumlogit_po6[-i])/(nsim-1)


  MC_YMinusi_mse1_ppo[i] = sum(mse_cumlogit_ppo1[-i])/(nsim-1)
  MC_YMinusi_mse2_ppo[i] = sum(mse_cumlogit_ppo2[-i])/(nsim-1)
  MC_YMinusi_mse3_ppo[i] = sum(mse_cumlogit_ppo3[-i])/(nsim-1)
  MC_YMinusi_mse4_ppo[i] = sum(mse_cumlogit_ppo4[-i])/(nsim-1)
  MC_YMinusi_mse5_ppo[i] = sum(mse_cumlogit_ppo5[-i])/(nsim-1)
  MC_YMinusi_mse6_ppo[i] = sum(mse_cumlogit_ppo6[-i])/(nsim-1)

  
  MC_YMinusi_mse1_cpo[i] = sum(mse_cumlogit_cpo1[-i])/(nsim-1)
  MC_YMinusi_mse2_cpo[i] = sum(mse_cumlogit_cpo2[-i])/(nsim-1)
  MC_YMinusi_mse3_cpo[i] = sum(mse_cumlogit_cpo3[-i])/(nsim-1)
  MC_YMinusi_mse4_cpo[i] = sum(mse_cumlogit_cpo4[-i])/(nsim-1)
  MC_YMinusi_mse5_cpo[i] = sum(mse_cumlogit_cpo5[-i])/(nsim-1)
  MC_YMinusi_mse6_cpo[i] = sum(mse_cumlogit_cpo6[-i])/(nsim-1)

  
  MC_YMinusi_mse1_lcpo[i] = sum(mse_cumlogit_lcpo1[-i])/(nsim-1)
  MC_YMinusi_mse2_lcpo[i] = sum(mse_cumlogit_lcpo2[-i])/(nsim-1)
  MC_YMinusi_mse3_lcpo[i] = sum(mse_cumlogit_lcpo3[-i])/(nsim-1)
  MC_YMinusi_mse4_lcpo[i] = sum(mse_cumlogit_lcpo4[-i])/(nsim-1)
  MC_YMinusi_mse5_lcpo[i] = sum(mse_cumlogit_lcpo5[-i])/(nsim-1)
  MC_YMinusi_mse6_lcpo[i] = sum(mse_cumlogit_lcpo6[-i])/(nsim-1)

  MC_YMinusi_mse1_lr[i] = sum(mse_cumlogit_lr1[-i])/(nsim-1)
  MC_YMinusi_mse2_lr[i] = sum(mse_cumlogit_lr2[-i])/(nsim-1) 
  MC_YMinusi_mse3_lr[i] = sum(mse_cumlogit_lr3[-i])/(nsim-1) 
  MC_YMinusi_mse4_lr[i] = sum(mse_cumlogit_lr4[-i])/(nsim-1) 
  MC_YMinusi_mse5_lr[i] = sum(mse_cumlogit_lr5[-i])/(nsim-1) 
  MC_YMinusi_mse6_lr[i] = sum(mse_cumlogit_lr6[-i])/(nsim-1) 
}

bar_MC_YMinusi_mse1_po = sum(MC_YMinusi_mse1_po)/nsim
bar_MC_YMinusi_mse2_po = sum(MC_YMinusi_mse2_po)/nsim
bar_MC_YMinusi_mse3_po = sum(MC_YMinusi_mse3_po)/nsim
bar_MC_YMinusi_mse4_po = sum(MC_YMinusi_mse4_po)/nsim
bar_MC_YMinusi_mse5_po = sum(MC_YMinusi_mse5_po)/nsim
bar_MC_YMinusi_mse6_po = sum(MC_YMinusi_mse6_po)/nsim

bar_MC_YMinusi_mse1_ppo = sum(MC_YMinusi_mse1_ppo)/nsim
bar_MC_YMinusi_mse2_ppo = sum(MC_YMinusi_mse2_ppo)/nsim
bar_MC_YMinusi_mse3_ppo = sum(MC_YMinusi_mse3_ppo)/nsim
bar_MC_YMinusi_mse4_ppo = sum(MC_YMinusi_mse4_ppo)/nsim
bar_MC_YMinusi_mse5_ppo = sum(MC_YMinusi_mse5_ppo)/nsim
bar_MC_YMinusi_mse6_ppo = sum(MC_YMinusi_mse6_ppo)/nsim


bar_MC_YMinusi_mse1_cpo = sum(MC_YMinusi_mse1_cpo)/nsim
bar_MC_YMinusi_mse2_cpo = sum(MC_YMinusi_mse2_cpo)/nsim
bar_MC_YMinusi_mse3_cpo = sum(MC_YMinusi_mse3_cpo)/nsim
bar_MC_YMinusi_mse4_cpo = sum(MC_YMinusi_mse4_cpo)/nsim
bar_MC_YMinusi_mse5_cpo = sum(MC_YMinusi_mse5_cpo)/nsim
bar_MC_YMinusi_mse6_cpo = sum(MC_YMinusi_mse6_cpo)/nsim


bar_MC_YMinusi_mse1_lcpo = sum(MC_YMinusi_mse1_lcpo)/nsim
bar_MC_YMinusi_mse2_lcpo = sum(MC_YMinusi_mse2_lcpo)/nsim
bar_MC_YMinusi_mse3_lcpo = sum(MC_YMinusi_mse3_lcpo)/nsim
bar_MC_YMinusi_mse4_lcpo = sum(MC_YMinusi_mse4_lcpo)/nsim
bar_MC_YMinusi_mse5_lcpo = sum(MC_YMinusi_mse5_lcpo)/nsim
bar_MC_YMinusi_mse6_lcpo = sum(MC_YMinusi_mse6_lcpo)/nsim

bar_MC_YMinusi_mse1_lr = sum(MC_YMinusi_mse1_lr)/nsim
bar_MC_YMinusi_mse2_lr = sum(MC_YMinusi_mse2_lr)/nsim
bar_MC_YMinusi_mse3_lr = sum(MC_YMinusi_mse3_lr)/nsim
bar_MC_YMinusi_mse4_lr = sum(MC_YMinusi_mse4_lr)/nsim
bar_MC_YMinusi_mse5_lr = sum(MC_YMinusi_mse5_lr)/nsim
bar_MC_YMinusi_mse6_lr = sum(MC_YMinusi_mse6_lr)/nsim


MCE_JK_mse1_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse1_po-bar_MC_YMinusi_mse1_po)^2))
MCE_JK_mse2_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse2_po-bar_MC_YMinusi_mse2_po)^2))
MCE_JK_mse3_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse3_po-bar_MC_YMinusi_mse3_po)^2))
MCE_JK_mse4_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse4_po-bar_MC_YMinusi_mse4_po)^2))
MCE_JK_mse5_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse5_po-bar_MC_YMinusi_mse5_po)^2))
MCE_JK_mse6_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse6_po-bar_MC_YMinusi_mse6_po)^2))

MCE_JK_mse1_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse1_ppo-bar_MC_YMinusi_mse1_ppo)^2))
MCE_JK_mse2_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse2_ppo-bar_MC_YMinusi_mse2_ppo)^2))
MCE_JK_mse3_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse3_ppo-bar_MC_YMinusi_mse3_ppo)^2))
MCE_JK_mse4_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse4_ppo-bar_MC_YMinusi_mse4_ppo)^2))
MCE_JK_mse5_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse5_ppo-bar_MC_YMinusi_mse5_ppo)^2))
MCE_JK_mse6_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse6_ppo-bar_MC_YMinusi_mse6_ppo)^2))


MCE_JK_mse1_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse1_cpo-bar_MC_YMinusi_mse1_cpo)^2))
MCE_JK_mse2_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse2_cpo-bar_MC_YMinusi_mse2_cpo)^2))
MCE_JK_mse3_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse3_cpo-bar_MC_YMinusi_mse3_cpo)^2))
MCE_JK_mse4_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse4_cpo-bar_MC_YMinusi_mse4_cpo)^2))
MCE_JK_mse5_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse5_cpo-bar_MC_YMinusi_mse5_cpo)^2))
MCE_JK_mse6_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse6_cpo-bar_MC_YMinusi_mse6_cpo)^2))


MCE_JK_mse1_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse1_lcpo-bar_MC_YMinusi_mse1_lcpo)^2))
MCE_JK_mse2_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse2_lcpo-bar_MC_YMinusi_mse2_lcpo)^2))
MCE_JK_mse3_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse3_lcpo-bar_MC_YMinusi_mse3_lcpo)^2))
MCE_JK_mse4_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse4_lcpo-bar_MC_YMinusi_mse4_lcpo)^2))
MCE_JK_mse5_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse5_lcpo-bar_MC_YMinusi_mse5_lcpo)^2))
MCE_JK_mse6_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse6_lcpo-bar_MC_YMinusi_mse6_lcpo)^2))


MCE_JK_mse1_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse1_lr-bar_MC_YMinusi_mse1_lr)^2))
MCE_JK_mse2_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse2_lr-bar_MC_YMinusi_mse2_lr)^2))
MCE_JK_mse3_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse3_lr-bar_MC_YMinusi_mse3_lr)^2))
MCE_JK_mse4_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse4_lr-bar_MC_YMinusi_mse4_lr)^2))
MCE_JK_mse5_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse5_lr-bar_MC_YMinusi_mse5_lr)^2))
MCE_JK_mse6_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_mse6_lr-bar_MC_YMinusi_mse6_lr)^2))

```


## Relative bias across each model and cumulative logit 
```{r}
#PO model 
relbias_po1 <- (exp(bias_po1+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_po2 <- (exp(bias_po2+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_po3 <- (exp(bias_po3+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_po4 <- (exp(bias_po4+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_po5 <- (exp(bias_po5+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_po6 <- (exp(bias_po6+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))


# PPO model 
relbias_ppo1 <- (exp(bias_ppo1+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_ppo2 <- (exp(bias_ppo2+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_ppo3 <- (exp(bias_ppo3+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_ppo4 <- (exp(bias_ppo4+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_ppo5 <- (exp(bias_ppo5+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_ppo6 <- (exp(bias_ppo6+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))



# Constrained - divergent 
relbias_cpo1 <- (exp(bias_cpo1+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_cpo2 <- (exp(bias_cpo2+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_cpo3 <- (exp(bias_cpo3+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_cpo4 <- (exp(bias_cpo4+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_cpo5 <- (exp(bias_cpo5+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_cpo6 <- (exp(bias_cpo6+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))



# Constrained - linear 
relbias_lcpo1 <- (exp(bias_lcpo1+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lcpo2 <- (exp(bias_lcpo2+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lcpo3 <- (exp(bias_lcpo3+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lcpo4 <- (exp(bias_lcpo4+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lcpo5 <- (exp(bias_lcpo5+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lcpo6 <- (exp(bias_lcpo6+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))


# Logistic 
relbias_lr1 <- (exp(bias_lr1+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lr2 <- (exp(bias_lr2+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lr3 <- (exp(bias_lr3+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lr4 <- (exp(bias_lr4+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lr5 <- (exp(bias_lr5+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
relbias_lr6 <- (exp(bias_lr6+log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
```


## Compute jackknife-after-bootstrap Monte Carlo standard error estimation -  RELATIVE BIAS 
## These should be <0.05, otherwise increase n_sim 
```{r}
nsim <- 1000

MC_YMinusi_relbias1_po <- MC_YMinusi_relbias2_po <- MC_YMinusi_relbias3_po <- MC_YMinusi_relbias4_po <- MC_YMinusi_relbias5_po <- MC_YMinusi_relbias6_po <- MC_YMinusi_relbias1_ppo <- MC_YMinusi_relbias2_ppo <- MC_YMinusi_relbias3_ppo <- MC_YMinusi_relbias4_ppo <- MC_YMinusi_relbias5_ppo <- MC_YMinusi_relbias6_ppo <- MC_YMinusi_relbias1_cpo <- MC_YMinusi_relbias2_cpo <- MC_YMinusi_relbias3_cpo <- MC_YMinusi_relbias4_cpo <- MC_YMinusi_relbias5_cpo <- MC_YMinusi_relbias6_cpo <- MC_YMinusi_relbias1_lcpo <- MC_YMinusi_relbias2_lcpo <- MC_YMinusi_relbias3_lcpo <- MC_YMinusi_relbias4_lcpo <- MC_YMinusi_relbias5_lcpo <- MC_YMinusi_relbias6_lcpo <- MC_YMinusi_relbias1_lr <- MC_YMinusi_relbias2_lr <- MC_YMinusi_relbias3_lr <- MC_YMinusi_relbias4_lr <- MC_YMinusi_relbias5_lr <- MC_YMinusi_relbias6_lr <- numeric(nsim)

for(i in 1:nsim){
  MC_YMinusi_relbias1_po[i] = (exp(sum(bias_cumlogit_po1[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias2_po[i] = (exp(sum(bias_cumlogit_po2[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias3_po[i] = (exp(sum(bias_cumlogit_po3[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias4_po[i] = (exp(sum(bias_cumlogit_po4[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias5_po[i] = (exp(sum(bias_cumlogit_po5[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias6_po[i] = (exp(sum(bias_cumlogit_po6[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))


  MC_YMinusi_relbias1_ppo[i] = (exp(sum(bias_cumlogit_ppo1[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias2_ppo[i] = (exp(sum(bias_cumlogit_ppo2[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias3_ppo[i] = (exp(sum(bias_cumlogit_ppo3[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias4_ppo[i] = (exp(sum(bias_cumlogit_ppo4[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias5_ppo[i] = (exp(sum(bias_cumlogit_ppo5[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias6_ppo[i] = (exp(sum(bias_cumlogit_ppo6[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))

  
  MC_YMinusi_relbias1_cpo[i] = (exp(sum(bias_cumlogit_cpo1[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias2_cpo[i] = (exp(sum(bias_cumlogit_cpo2[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias3_cpo[i] = (exp(sum(bias_cumlogit_cpo3[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias4_cpo[i] = (exp(sum(bias_cumlogit_cpo4[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias5_cpo[i] = (exp(sum(bias_cumlogit_cpo5[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias6_cpo[i] = (exp(sum(bias_cumlogit_cpo6[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))

  
  MC_YMinusi_relbias1_lcpo[i] = (exp(sum(bias_cumlogit_lcpo1[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias2_lcpo[i] = (exp(sum(bias_cumlogit_lcpo2[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias3_lcpo[i] = (exp(sum(bias_cumlogit_lcpo3[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias4_lcpo[i] = (exp(sum(bias_cumlogit_lcpo4[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias5_lcpo[i] = (exp(sum(bias_cumlogit_lcpo5[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias6_lcpo[i] = (exp(sum(bias_cumlogit_lcpo6[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))

  MC_YMinusi_relbias1_lr[i] = (exp(sum(bias_cumlogit_lr1[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias2_lr[i] = (exp(sum(bias_cumlogit_lr2[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias3_lr[i] = (exp(sum(bias_cumlogit_lr3[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias4_lr[i] = (exp(sum(bias_cumlogit_lr4[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias5_lr[i] = (exp(sum(bias_cumlogit_lr5[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
  MC_YMinusi_relbias6_lr[i] = (exp(sum(bias_cumlogit_lr6[-i])/(nsim-1) + log(1.5))-exp(log(1.5)))/(exp(log(1.5)))
}

bar_MC_YMinusi_relbias1_po = sum(MC_YMinusi_relbias1_po)/nsim
bar_MC_YMinusi_relbias2_po = sum(MC_YMinusi_relbias2_po)/nsim
bar_MC_YMinusi_relbias3_po = sum(MC_YMinusi_relbias3_po)/nsim
bar_MC_YMinusi_relbias4_po = sum(MC_YMinusi_relbias4_po)/nsim
bar_MC_YMinusi_relbias5_po = sum(MC_YMinusi_relbias5_po)/nsim
bar_MC_YMinusi_relbias6_po = sum(MC_YMinusi_relbias6_po)/nsim

bar_MC_YMinusi_relbias1_ppo = sum(MC_YMinusi_relbias1_ppo)/nsim
bar_MC_YMinusi_relbias2_ppo = sum(MC_YMinusi_relbias2_ppo)/nsim
bar_MC_YMinusi_relbias3_ppo = sum(MC_YMinusi_relbias3_ppo)/nsim
bar_MC_YMinusi_relbias4_ppo = sum(MC_YMinusi_relbias4_ppo)/nsim
bar_MC_YMinusi_relbias5_ppo = sum(MC_YMinusi_relbias5_ppo)/nsim
bar_MC_YMinusi_relbias6_ppo = sum(MC_YMinusi_relbias6_ppo)/nsim

bar_MC_YMinusi_relbias1_cpo = sum(MC_YMinusi_relbias1_cpo)/nsim
bar_MC_YMinusi_relbias2_cpo = sum(MC_YMinusi_relbias2_cpo)/nsim
bar_MC_YMinusi_relbias3_cpo = sum(MC_YMinusi_relbias3_cpo)/nsim
bar_MC_YMinusi_relbias4_cpo = sum(MC_YMinusi_relbias4_cpo)/nsim
bar_MC_YMinusi_relbias5_cpo = sum(MC_YMinusi_relbias5_cpo)/nsim
bar_MC_YMinusi_relbias6_cpo = sum(MC_YMinusi_relbias6_cpo)/nsim


bar_MC_YMinusi_relbias1_lcpo = sum(MC_YMinusi_relbias1_lcpo)/nsim
bar_MC_YMinusi_relbias2_lcpo = sum(MC_YMinusi_relbias2_lcpo)/nsim
bar_MC_YMinusi_relbias3_lcpo = sum(MC_YMinusi_relbias3_lcpo)/nsim
bar_MC_YMinusi_relbias4_lcpo = sum(MC_YMinusi_relbias4_lcpo)/nsim
bar_MC_YMinusi_relbias5_lcpo = sum(MC_YMinusi_relbias5_lcpo)/nsim
bar_MC_YMinusi_relbias6_lcpo = sum(MC_YMinusi_relbias6_lcpo)/nsim

bar_MC_YMinusi_relbias1_lr = sum(MC_YMinusi_relbias1_lr)/nsim
bar_MC_YMinusi_relbias2_lr = sum(MC_YMinusi_relbias2_lr)/nsim
bar_MC_YMinusi_relbias3_lr = sum(MC_YMinusi_relbias3_lr)/nsim
bar_MC_YMinusi_relbias4_lr = sum(MC_YMinusi_relbias4_lr)/nsim
bar_MC_YMinusi_relbias5_lr = sum(MC_YMinusi_relbias5_lr)/nsim
bar_MC_YMinusi_relbias6_lr = sum(MC_YMinusi_relbias6_lr)/nsim

MCE_JK_relbias1_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias1_po-bar_MC_YMinusi_relbias1_po)^2))
MCE_JK_relbias2_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias2_po-bar_MC_YMinusi_relbias2_po)^2))
MCE_JK_relbias3_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias3_po-bar_MC_YMinusi_relbias3_po)^2))
MCE_JK_relbias4_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias4_po-bar_MC_YMinusi_relbias4_po)^2))
MCE_JK_relbias5_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias5_po-bar_MC_YMinusi_relbias5_po)^2))
MCE_JK_relbias6_po = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias6_po-bar_MC_YMinusi_relbias6_po)^2))

MCE_JK_relbias1_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias1_ppo-bar_MC_YMinusi_relbias1_ppo)^2))
MCE_JK_relbias2_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias2_ppo-bar_MC_YMinusi_relbias2_ppo)^2))
MCE_JK_relbias3_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias3_ppo-bar_MC_YMinusi_relbias3_ppo)^2))
MCE_JK_relbias4_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias4_ppo-bar_MC_YMinusi_relbias4_ppo)^2))
MCE_JK_relbias5_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias5_ppo-bar_MC_YMinusi_relbias5_ppo)^2))
MCE_JK_relbias6_ppo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias6_ppo-bar_MC_YMinusi_relbias6_ppo)^2))

MCE_JK_relbias1_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias1_cpo-bar_MC_YMinusi_relbias1_cpo)^2))
MCE_JK_relbias2_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias2_cpo-bar_MC_YMinusi_relbias2_cpo)^2))
MCE_JK_relbias3_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias3_cpo-bar_MC_YMinusi_relbias3_cpo)^2))
MCE_JK_relbias4_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias4_cpo-bar_MC_YMinusi_relbias4_cpo)^2))
MCE_JK_relbias5_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias5_cpo-bar_MC_YMinusi_relbias5_cpo)^2))
MCE_JK_relbias6_cpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias6_cpo-bar_MC_YMinusi_relbias6_cpo)^2))

MCE_JK_relbias1_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias1_lcpo-bar_MC_YMinusi_relbias1_lcpo)^2))
MCE_JK_relbias2_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias2_lcpo-bar_MC_YMinusi_relbias2_lcpo)^2))
MCE_JK_relbias3_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias3_lcpo-bar_MC_YMinusi_relbias3_lcpo)^2))
MCE_JK_relbias4_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias4_lcpo-bar_MC_YMinusi_relbias4_lcpo)^2))
MCE_JK_relbias5_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias5_lcpo-bar_MC_YMinusi_relbias5_lcpo)^2))
MCE_JK_relbias6_lcpo = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias6_lcpo-bar_MC_YMinusi_relbias6_lcpo)^2))

MCE_JK_relbias1_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias1_lr-bar_MC_YMinusi_relbias1_lr)^2))
MCE_JK_relbias2_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias2_lr-bar_MC_YMinusi_relbias2_lr)^2))
MCE_JK_relbias3_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias3_lr-bar_MC_YMinusi_relbias3_lr)^2))
MCE_JK_relbias4_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias4_lr-bar_MC_YMinusi_relbias4_lr)^2))
MCE_JK_relbias5_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias5_lr-bar_MC_YMinusi_relbias5_lr)^2))
MCE_JK_relbias6_lr = sqrt(((nsim-1)/nsim)*sum((MC_YMinusi_relbias6_lr-bar_MC_YMinusi_relbias6_lr)^2))

```

## Generate data frame - bias, SE, coverage, SE, MSE, SE, model, cum logit  
```{r}
bias <- c(bias_po1,bias_po2,bias_po3,bias_po4,bias_po5,bias_po6,bias_ppo1,bias_ppo2,bias_ppo3,bias_ppo4,bias_ppo5,bias_ppo6,bias_cpo1,bias_cpo2,bias_cpo3,bias_cpo4,bias_cpo5,bias_cpo6,bias_lcpo1,bias_lcpo2,bias_lcpo3,bias_lcpo4,bias_lcpo5,bias_lcpo6,bias_lr1, bias_lr2, bias_lr3, bias_lr4, bias_lr5, bias_lr6)

bias_se <- c(MCE_JK_bias1_po,MCE_JK_bias2_po,MCE_JK_bias3_po,MCE_JK_bias4_po,MCE_JK_bias5_po,MCE_JK_bias6_po,MCE_JK_bias1_ppo,MCE_JK_bias2_ppo,MCE_JK_bias3_ppo,MCE_JK_bias4_ppo,MCE_JK_bias5_ppo,MCE_JK_bias6_ppo,MCE_JK_bias1_cpo,MCE_JK_bias2_cpo,MCE_JK_bias3_cpo,MCE_JK_bias4_cpo,MCE_JK_bias5_cpo,MCE_JK_bias6_cpo,MCE_JK_bias1_lcpo,MCE_JK_bias2_lcpo,MCE_JK_bias3_lcpo,MCE_JK_bias4_lcpo,MCE_JK_bias5_lcpo,MCE_JK_bias6_lcpo,MCE_JK_bias1_lr,MCE_JK_bias2_lr,MCE_JK_bias3_lr,MCE_JK_bias4_lr,MCE_JK_bias5_lr,MCE_JK_bias6_lr)

coverage <- c(cv_po1, cv_po2, cv_po3, cv_po4, cv_po5, cv_po6, cv_ppo1, cv_ppo2, cv_ppo3, cv_ppo4, cv_ppo5, cv_ppo6, cv_cpo1, cv_cpo2, cv_cpo3, cv_cpo4, cv_cpo5, cv_cpo6,cv_lcpo1, cv_lcpo2, cv_lcpo3, cv_lcpo4, cv_lcpo5, cv_lcpo6, cv_lr1, cv_lr2, cv_lr3, cv_lr4, cv_lr5, cv_lr6)

coverage_se <- c(MCE_JK_cv1_po,MCE_JK_cv2_po,MCE_JK_cv3_po,MCE_JK_cv4_po,MCE_JK_cv5_po,MCE_JK_cv6_po,MCE_JK_cv1_ppo,MCE_JK_cv2_ppo,MCE_JK_cv3_ppo,MCE_JK_cv4_ppo,MCE_JK_cv5_ppo,MCE_JK_cv6_ppo,MCE_JK_cv1_cpo,MCE_JK_cv2_cpo,MCE_JK_cv3_cpo,MCE_JK_cv4_cpo,MCE_JK_cv5_cpo,MCE_JK_cv6_cpo,MCE_JK_cv1_lcpo,MCE_JK_cv2_lcpo,MCE_JK_cv3_lcpo,MCE_JK_cv4_lcpo,MCE_JK_cv5_lcpo,MCE_JK_cv6_lcpo,MCE_JK_cv1_lr,MCE_JK_cv2_lr,MCE_JK_cv3_lr,MCE_JK_cv4_lr,MCE_JK_cv5_lr,MCE_JK_cv6_lr)

mse <- c(mse_po1, mse_po2, mse_po3, mse_po4, mse_po5, mse_po6, mse_ppo1, mse_ppo2, mse_ppo3, mse_ppo4, mse_ppo5, mse_ppo6, mse_cpo1, mse_cpo2, mse_cpo3, mse_cpo4, mse_cpo5, mse_cpo6, mse_lcpo1, mse_lcpo2, mse_lcpo3, mse_lcpo4, mse_lcpo5, mse_lcpo6, mse_lr1, mse_lr2, mse_lr3, mse_lr4, mse_lr5, mse_lr6)

mse_se <- c(MCE_JK_mse1_po,MCE_JK_mse2_po,MCE_JK_mse3_po,MCE_JK_mse4_po,MCE_JK_mse5_po,MCE_JK_mse6_po,MCE_JK_mse1_ppo,MCE_JK_mse2_ppo,MCE_JK_mse3_ppo,MCE_JK_mse4_ppo,MCE_JK_mse5_ppo,MCE_JK_mse6_ppo,MCE_JK_mse1_cpo,MCE_JK_mse2_cpo,MCE_JK_mse3_cpo,MCE_JK_mse4_cpo,MCE_JK_mse5_cpo,MCE_JK_mse6_cpo,MCE_JK_mse1_lcpo,MCE_JK_mse2_lcpo,MCE_JK_mse3_lcpo,MCE_JK_mse4_lcpo,MCE_JK_mse5_lcpo,MCE_JK_mse6_lcpo,MCE_JK_mse1_lr,MCE_JK_mse2_lr,MCE_JK_mse3_lr,MCE_JK_mse4_lr,MCE_JK_mse5_lr,MCE_JK_mse6_lr)

cumlogit <- rep(1:6,5)

model <- c(rep("PO",6),rep("PPO",6),rep("CPO",6),rep("LCPO",6),rep("LR",6))

category <- rep(7,30)

effectsize <- rep("Moderate [1.50]", 30)

truemod <- rep("Random PO [slight violation]", 30)

controlprob <- rep("Skewed", 30)

sampsize <- rep(10000, 30)

relbias <- c(relbias_po1,relbias_po2,relbias_po3,relbias_po4,relbias_po5,relbias_po6,relbias_ppo1,relbias_ppo2,relbias_ppo3,relbias_ppo4,relbias_ppo5,relbias_ppo6,relbias_cpo1,relbias_cpo2,relbias_cpo3,relbias_cpo4,relbias_cpo5,relbias_cpo6,relbias_lcpo1,relbias_lcpo2,relbias_lcpo3,relbias_lcpo4,relbias_lcpo5,relbias_lcpo6 ,relbias_lr1, relbias_lr2, relbias_lr3, relbias_lr4, relbias_lr5, relbias_lr6)

relbias_se <- c(MCE_JK_relbias1_po,MCE_JK_relbias2_po,MCE_JK_relbias3_po,MCE_JK_relbias4_po,MCE_JK_relbias5_po,MCE_JK_relbias6_po,MCE_JK_relbias1_ppo,MCE_JK_relbias2_ppo,MCE_JK_relbias3_ppo,MCE_JK_relbias4_ppo,MCE_JK_relbias5_ppo,MCE_JK_relbias6_ppo,MCE_JK_relbias1_cpo,MCE_JK_relbias2_cpo,MCE_JK_relbias3_cpo,MCE_JK_relbias4_cpo,MCE_JK_relbias5_cpo,MCE_JK_relbias6_cpo,MCE_JK_relbias1_lcpo,MCE_JK_relbias2_lcpo,MCE_JK_relbias3_lcpo,MCE_JK_relbias4_lcpo,MCE_JK_relbias5_lcpo,MCE_JK_relbias6_lcpo,MCE_JK_relbias1_lr,MCE_JK_relbias2_lr,MCE_JK_relbias3_lr,MCE_JK_relbias4_lr,MCE_JK_relbias5_lr,MCE_JK_relbias6_lr)

results <- data.frame(bias = bias, bias_se = bias_se, relbias = relbias, relbias_se = relbias_se, coverage = coverage, coverage_se = coverage_se, mse = mse, mse_se = mse_se, cumlogit = cumlogit, model = model, category = category, effectsize = effectsize, truemod = truemod, controlprob = controlprob, sampsize = sampsize)

save(results, file = "vlargen_skew_7cat_randompo_modeff_slight_results.Rdata")
write.csv(results,file="G:/BACKUP/Chris/Project_2/Main_Simulations/Results/results_123.csv")

```
